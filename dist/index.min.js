!function(a,b){"function"==typeof define&&define.amd?define([],b):"undefined"!=typeof module?module.exports=b:a.MonkberryFlux=b()}(this,function(){"use strict";var a=Array.prototype.slice,b=Array.prototype.push,c={},d={},e={};return e.createStore=function(a){var b=Object.assign({},d);return b.name=a.name,b.listenables=[],c[b.name]={state:a.state,actions:a.actions},b},d.dispatch=function(d,e){var f=a.call(arguments,2),g=[c[this.name].state],h=this,i=h.name;b.apply(g,f),new Promise(function(a,b){c[i].actions[e].apply(null,g),a(c[i].state[d])}).then(function(a){h.hasOwnProperty("handler")&&h.handler(h.listenables,d,a)})},d.subscribe=function(a){this.listenables.push(a)},d.unsubscribe=function(a){var b=this;this.listenables.forEach(function(c,d){c===a&&b.listenables.splice(d,1)})},d.observe=function(a){this.handler=a},d.getState=function(a){return void 0===a?c[this.name].state:c[this.name].state[a]},e});